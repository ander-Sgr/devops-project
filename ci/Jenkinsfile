pipeline {
    agent any
    environment {
        DOCKER_IMAGE = 'python:3.11'
    }
    stages {
        stage('Checkout from scm') {
            steps {
                checkout scm
            }
        }
        stage('Construir y correr el servicio de prueba') {
            steps {
                script {
                    docker.image(DOCKER_IMAGE).inside {
                        sh 'pip install -r requirements-test.txt'  // Instala las dependencias necesarias
                        sh 'pytest --maxfail=1 --disable-warnings -q'  // Ejecuta los tests
                    }
                }
            }
        }
    }
}